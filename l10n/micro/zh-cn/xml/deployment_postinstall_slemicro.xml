<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_postinstall_slemicro.xml" version="5.0" xml:id="cha-postintall-registration">
 <title>部署后步骤</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
  <abstract>
    <para>
      本章介绍如何注册 SLE Micro 以及适用于 SLE Micro 的扩展。
    </para>
  </abstract>
 </info>
 <sect1 xml:id="sec-images-registration">
  <title>注册</title>

  <para>
   可以在命令行中使用 <command>transactional-update register</command> 命令来注册系统。有关超出本节范畴的信息，请使用 <command>SUSEConnect --help</command> 查看内联文档。
  </para>

  <procedure>
   <title>使用 SUSEConnect 注册产品</title>
   <step>
    <para>
     要在 SUSE Customer Center 中注册 <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>，请按如下所示运行 <command>transactional-update register</command>：
    </para>
<screen><prompt role="root"># </prompt>transactional-update register -r <replaceable>REGISTRATION_CODE</replaceable> -e <replaceable>EMAIL_ADDRESS</replaceable></screen>
    <para>
     要在本地注册服务器中注册，另请提供该服务器的 URL：
    </para>
<screen><prompt role="root"># </prompt>transactional-update register -r <replaceable>REGISTRATION_CODE</replaceable> -e <replaceable>EMAIL_ADDRESS</replaceable> \
--url "https://suse_register.example.com/"</screen>
    <para>
     将 <replaceable>REGISTRATION_CODE</replaceable> 替换为与 <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> 副本一同收到的注册码。将 <replaceable>EMAIL_ADDRESS</replaceable> 替换为与您或您的组织管理订阅时所用的 SUSE 帐户关联的电子邮件地址。
    </para>
   </step>
   <step>
    <para>
     <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> 现已注册完毕。
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec-adding-extension">
  <title>管理扩展</title>

  <para>
   SLE Micro 支持内核在线增补扩展。请注意，您可能需要额外订阅该扩展。
  </para>

  <note>
   <title><literal>SUSE Linux Enterprise Live Patching</literal> 可用性</title>
   <para>
    <literal>SUSE Linux Enterprise Live Patching</literal> 扩展仅适用于 x86（实时内核除外）和 IBM Z 体系结构。
   </para>
  </note>

  <para>
   由于该扩展的激活或停用以事务更新方式进行，因而会创建新的快照，您需要重启动系统才能引导到新的快照并应用更改。
  </para>

  <sect2 xml:id="sec-slemicro-live-patching">
   <title>激活 <literal>SUSE Linux Enterprise Live Patching</literal></title>
   <para>
    如果您需要激活在线增补扩展，请运行以下命令列出可用扩展：
   </para>
<screen><prompt role="root"># </prompt>transactional-update --quiet register -list-extensions</screen>
   <para>
    输出中会提供有关如何激活在线增补扩展的命令：
   </para>
<screen>
<prompt role="root"># </prompt>transactional-update register -p sle-module-live-patching/15.3/x86_64 \
  -r <replaceable>registration code</replaceable>
</screen>
   <para>
    激活 <literal>SUSE Linux Enterprise Live Patching</literal> 扩展后，在 <filename>/etc/zypp/zypp.conf</filename> 文件中按如下方式配置 <literal>libzypp</literal>：
   </para>
   <variablelist>
    <varlistentry>
     <term><literal>multiversion = provides:multiversion(kernel)</literal></term>
     <listitem>
      <para>
       这会在增补系统的同时，确保当前内核保持运行状态，否则，在应用内核更新时可能会发生依赖项冲突。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>multiversion.kernels = latest</literal></term>
     <listitem>
      <para>
       这会在应用在线补丁后在新快照中执行内核清理。如果未设置此命令，快照将保留之前的内核，并且也会在之前的内核上执行内核更新。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    另外，请在 <filename>/etc/sysconfig/livepatching</filename> 文件中设置 <literal>LIVEPATCH_KERNEL='always'</literal>。
   </para>
   <note>
    <title>与内核匹配的 <literal>kernel-default-livepatch</literal> 版本</title>
    <para>
     为了确保内核升级后仍会安装在线补丁，请安装匹配版本的 <literal>kernel-default-livepatch</literal> 软件包。
    </para>
   </note>
  </sect2>

  <sect2 xml:id="sec-disable-live-patching">
   <title>停用 <literal>SUSE Linux Enterprise Live Patching</literal></title>
   <para>
    要停用该扩展，请运行以下命令：
   </para>
<screen>
<prompt role="root"># </prompt>transactional-update register -d \
  -p sle-module-live-patching/15.3/x86_64
</screen>
  </sect2>
 </sect1>
</chapter>
