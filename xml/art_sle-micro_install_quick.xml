<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook50-profile.xsl"
                 type="text/xml"
                 title="Profiling step"?>
<!DOCTYPE article
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>

<?provo dirname="installquick/"?>
<article xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="art-slemicro-installquick" xml:lang="en">
<?suse-quickstart color="suse"?>
 <title>&instquick;</title>
 <subtitle>&productname; &productnumber;</subtitle>
 <info>
  <productnumber>&productnumber;</productnumber><productname>&productname;</productname><date>
<?dbtimestamp format="B d, Y"?></date>
  <abstract>
   <para>
    &abstract_installquick;
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker></dm:bugtracker>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <?suse-quickstart color="suse"?>
<sect1 xml:id="sec-slem-installquick">
	<title>Welcome to &productname;</title>
<para>&productname; is a modern system primary designed for edge computing. Main features of &productname; are predictibility and reliability thanks to the read-only root file system and transactional updates. The read-only file system ensures that the system cannot be altered during runtime and that the system behaves the same way after each reboot. Transactional updates enables updating the system without down time and always provide a rollback.</para>
<para>There are the following procedures of &productname; installation:</para>
<itemizedlist>
	<listitem>
	<para>manual installation, see <xref linkend="sec-slem-manual-installation"/></para>
</listitem>
<listitem>
	<para>unattended automatic installation by using &ay;, see <xref linkend="sec-slem-autoyast"/></para>
</listitem>
<listitem>
	<para>deployment of prebuilt images, see <xref linkend="sec-slem-image-deployment"/>.</para>
</listitem>
</itemizedlist>

</sect1>
<sect1 xml:id="sec-slem-requirements">
	<title>&productname; hardware requirements</title>
<para>&productname; has the following minumum hardware requirements:</para>
<itemizedlist>
<listitem>
	<para>1 GB RAM</para>
</listitem>
<listitem>
	<para>12 GB HDD.</para>
</listitem>
</itemizedlist>
<para>
The recommended hard disk space is 20 GB for &slema; itself and 40 GB for containers data. Bear in mind that actual hardware requirements depend on workloads of your containers.
</para>
</sect1>

<sect1 xml:id="sec-slem-manual-installation">
	<title>The manual installation procedure</title>
<para>The following installation steps assume that you have succesfully booted to the installation system.</para>

<sect2 xml:id="sec-slem-licence-agreement">
	<title>The language and keyboard selection</title>
	<para>The default language and keyboard layout is English (US). If you want to choose a different language in the <guimenu>Language</guimenu> drop down menu. </para>
	<para>Read the licence agreement. The default languange is English, but the licence agreement is available in multiple languages. To get a particular translation, click <guimenu>Licence translations</guimenu> and in the drop-down menu select the desired language and click <guimenu>OK</guimenu>. After you read the licence agrement, check <guimenu>I Agree to the Licence Terms</guimenu> and click <guimenu>Next</guimenu> to proceed to the next installaton step.</para>
</sect2>
<sect2 xml:id="sec-slem-registration">
	<title>Registration</title>
<!--
<informalfigure>
    <mediaobject>
     <imageobject role="fo">
      <imagedata os="slemicro" fileref="install_registration_slem.png"
                 width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata os="slemicro" fileref="install_registration_slem.png"
                 width="100%"/>
      </imageobject>
    </mediaobject>
   </informalfigure>
-->
<para>
In order to receive technical support and product updates, you need to register and activate your &productname; with the &scc; or a local registration server.</para>
<variablelist>
    <varlistentry>
     <term><guimenu>Register system via scc.suse.com</guimenu></term>
     <listitem>
      <para>
       To register with the &scc;, enter the <guimenu>E-mail Address</guimenu>
       associated with your SCC account and the <guimenu>Registration
        Code</guimenu> for &productname;. Proceed with <guimenu>Next</guimenu>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Register system via local SMT server</guimenu></term>
     <listitem>
      <para>
       If your organization provides a local registration server, you may
       alternatively register there. Activate <guimenu>Register System via
        local SMT Server</guimenu> and either choose a URL from the drop-down
       box or type in an address. Proceed with <guimenu>Next</guimenu>.
      </para>
     </listitem>
    </varlistentry>
<varlistentry>
     <term><guimenu>Skip registration</guimenu></term>
     <listitem>
      <para>
       If you want to skip registration, click <guimenu>Skip
        Registration</guimenu>. Accept the warning with <guimenu>OK</guimenu> and
       proceed with <guimenu>Next</guimenu>.
      </para>
      <important>
       <title>Skipping the registration</title>
       <para>
        Your system needs to be registered in order to retrieve
        updates and to be eligible for support. Skipping the registration is
        only possible when installing from the
        <filename>&packagemedia;</filename> image.
       </para>
      </important>
      </listitem>
    </varlistentry>
   </variablelist>
<para>After completing the registraton, click <guimenu>Next</guimenu>.</para>
</sect2>
<sect2 xml:id="sec-slem-ntp">
	<title>NTP servers configuration</title>
<!--
<informalfigure>
    <mediaobject>
     <imageobject role="fo">
      <imagedata os="slemicro" fileref="install_ntp_slem.png"
                 width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata os="slemicro" fileref="install_ntp_slem.png"
                 width="100%"/>
      </imageobject>
    </mediaobject>
   </informalfigure> -->
<para>In order to keep time on your system properly synchronized, configure at least one NTP server.</para>
</sect2>
<sect2 xml:id="sec-slem-root-creation">
	<title>Authentication for &rootuser;</title>
<!--<informalfigure>
    <mediaobject>
     <imageobject role="fo">
      <imagedata os="slemicro" fileref="install_authentication_slem.png"
                 width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata os="slemicro" fileref="install_authentication_slem.png"
                 width="100%"/>
      </imageobject>
    </mediaobject>
   </informalfigure>
-->
<para>Configure a strong password for &rootuser;. You can import already existing ssh key by clicking <guimenu>Browse</guimenu> and selecting the ssh key.
</para>
<para>Click <guimenu>Next</guimenu> to proceed to the next installation step.</para>
</sect2>
<sect2 xml:id="sec-slem-installation-settings">
	<title>Installation settings</title>
<!--<informalfigure>
    <mediaobject>
     <imageobject role="fo">
      <imagedata os="slemicro" fileref="install_settings_slem.png"
                 width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata os="slemicro" fileref="install_settings_slem.png"
                 width="100%"/>
      </imageobject>
    </mediaobject>
   </informalfigure>
-->
<para>The last installation step provides a summary of installation settings, review the settings and&mdash;if necesasry&mdash;perform changes. To change a setting, click the setting headline.
</para>
<variablelist>
<varlistentry>
<term><guimenu>Partitioning</guimenu></term>
<listitem>
	<para>To modify partitions, you can use the <guimenu>Expert partiotioner</guimenu>. To encrypt your disk or to enable logical volume managment, click <guimenu>Guided Setup</guimenu> and then fill in a password  for the disk decryption.</para>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Software</guimenu></term>
<listitem>
	<para>Clicking <guimenu>Software</guimenu> opens the <guimenu>Software
       Selection and System Tasks</guimenu> screen, where you can change the
       software selection by selecting or deselecting patterns. Each pattern
       contains several software packages needed for specific functions. To view and manage these packages, click <guimenu>Details</guimenu>. </para>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Time Zone</guimenu></term>
<listitem>
	<para>By default the time is synchronized by using NTP servers you provided in previous steps of the installation procedure, but you can select the region and time zone. If you want to set the time and date manually, click the <guimenu>Other settings</guimenu> button and select <guimenu>Manually</guimenu>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Network Configuration</guimenu></term>
<listitem>
	<para>
       Displays the current network configuration. Click
       <guimenu>Network Configuration</guimenu> to change the settings. 
      </para>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Booting</guimenu></term>
<listitem>
	<para>
       This section shows the boot loader configuration. Changing the
       defaults is only recommended if really needed.
      </para>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Kdump</guimenu></term>
<listitem>
	<para>
       Kdump saves the memory image (<quote>core dump</quote>) to the file
       system in case the kernel crashes. This enables you to find the cause
       of the crash by debugging the dump file. Kdump is preconfigured and
       enabled by default. </para>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Default systemd target</guimenu></term>
<listitem>
	<para>Only the text mode is available.</para>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>System</guimenu></term>
<listitem>
	<para>View detailed hardware information by clicking
       <guimenu>System</guimenu>. In the resulting screen you can also change
       <guimenu>Kernel Settings</guimenu>&mdash;.</para>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Security</guimenu></term>
<listitem>
	<para>The <guimenu>CPU Mitigations</guimenu> refer to kernel boot command
       line parameters for software mitigations that have been deployed
       to prevent CPU side-channel attacks. Click the highlighted
       entry to choose a different option.</para>
<para>By default the firewall is disabled, click <guimenu>enable</guimenu> to change the default.</para>
<para>The ssh service is enabled by default, but the ssh port is blocked by default. To open the port, enable the firewall first and click <guimenu>Security</guimenu> and check the <guimenu>Open SSH Port</guimenu> checkbox. Bear in mind that if you disable the ssh service, you will not be able to login to your system remotly.</para>
<para>The default SELinux option is <guimenu>enforcing</guimenu>, you can change the value by clicking <guimenu>Security</guimenu> and selecting another option in the <guimenu>Mode</guimenu></para>
</listitem>
</varlistentry>
</variablelist>
<para>If you reviewed the installation settings, you can proceed to the installation by clicking <guimenu>Install</guimenu> and then confirming the installation.</para>
</sect2>
</sect1>

<sect1 xml:id="sec-slem-autoyast">
	<title>Unattended installation by using &ay;</title>
<para>
&productname; can be install by using &ay; by using a control file also called profile. &ay;  then installs &slema; as described in <xref
   linkend="book-autoyast"/> but omits the second stage. 
</para>
<para>The control file must be created manually and you can use the following template to do so.</para>

</sect1>
<sect1 xml:id="sec-slem-image-deployment">
<title>Raw image deployment</title>
<para>&productname;  provides raw images that can be directly deployed to your device storage&mdash;a memory card, USB flash drive or a hard disk.</para>
<para>To deploy the image, perform the following steps:</para>
<procedure>
<title>Deploying raw disk images</title>
<step>
 <para>Download the raw image and decompress it:</para>
<screen>xz -d &lt;downloaded_image.raw.xz&gt;</screen>
</step>
<step>
<para>Copy the decompressed image to the device:</para>
<screen>dd if=&lt;downloaded_image.raw&gt; of=/dev/sdX</screen>
</step>
<step>
<para>Label your installation volume <literal>ignition</literal>, no matter the configuration tool used. You can use any type of configuration storage media that your virtualization system or your hardware supports&mdash;iso image, a USB flash drive, etc.</para>
</step>
<step>
<para>Prior to booting for the first time, perform initial configuration by using Ignition or Combustion. The minimal configuration must provide a password for &rootuser;, otherwise the system will not be accessible after the first boot.</para>
</step>
<step>
<para>After the first boot you need to register your &slem; instance by using the command line tool <command>SUSEConnect</command>. For details refer to <xref linkend="sec-register-slem-system-suseconnect"/></para>
</step>
</procedure>


<sect2 xml:id="sec-slem-ignition">
<title>Congiguration by using Ignition</title>
<para>Ignition configures your system on the first boot according to the <filename>config.ign</filename> configuration file. The <filename>config.ign</filename> file must be placed in a directory <filename>ignition</filename>. The <filename>ignition</filename> directory as a subdirectory of the root directory. The root directory also contains the raw image to be deployed. The directory structure is then the following:</para>
<screen>
&lt;root directory&gt;
	- ignition
		- config.ign
	- raw disk image	
</screen>
<para>The <filename>config.ign</filename> is in the JSON format. A minimal example followws:</para>
<screen>
{
  "ignition": { "version": "3.1.0" },
  "passwd": {
    "users": [
      {
        "name": "root",
        "passwordHash": "pemFK1OejzrTI"
      }
    ]
  }
}
</screen>
<para>The example above sets a password for &rootuser; to <emphasis>opensuse</emphasis>. To obtain your own password hash, use the command:</para>
<screen>
&prompt.root; openssl passwd
</screen>

<sect3 xml:id="sec-ignition-flashdisk">
<title>Preparing a USB flash disk</title>
<para>Especially on bare metal systems, RaspberryPi or other ARM architectures, installing fron a USB flash disk may be the best solution. To prepare the USB flash disk, do the following:</para>
<procedure>
<title>Preparing a USB flash disk</title>
<step>
	<para>Format the disk to any file system supported by &slema;: FAT, EXT4, etc.</para>
</step>
<step>
	<para>Set the partition label to <literal>ignition</literal>. For EXT4 file system with one partition:</para>
<screen>e2label /dev/sdX1 ignition</screen>
</step>
<step>
<para>Mount the partition</para>
</step>
<step>
<para>Create the directory structure as mentioned in <xref linkend="sec-slem-ignition"/>.</para>
</step>	
</procedure>
</sect3>

<sect3 xml:id="sec-ignition-iso">
<title>Creating an iso file</title>
<para>Raw images can be used to create a custom iso files for your virtual machines. Create a directory structure required by Ignition, add the <filename>config.ign</filename> to the directory <filename>ignition</filename> and run the following command to make an iso file:</para>
<screen>
&prompt.root; mkisofs -o ignition.iso -V ignition /dev/sdX
</screen>
</sect3>
</sect2>
<sect2 xml:id="sec-slem-combustion">
	<title>Configuration by using Combustion</title>
<para>Combustion is a a minimal module for dracut. You can provide your script and Combustion runs the script on the first boot of the system. You can use Combustion to add files, install packages, set up devices and also repartition your disk. You can provide the configuration as a shell script on external storage that is run doring the booting process as a new system snapshot. If the process is successful, the system boots into the new snapshot.</para>
<para>To use Combustion on boot, create a directory <filename>combustion</filename> as a subdirectory of the root directory. To the <filename>combustion</filename> folder place the script. The script is then executed in a transactional update shell.</para>
<para>An example script follows:</para>
<screen>
#!/bin/bash
# combustion: network
# Redirect output to the console
exec > >(exec tee -a /dev/tty0) 2>&amp;1
# Set a password for root, generate the hash with "openssl passwd -6"
echo 'root:$5$.wn2BZHlEJ5R3B1C$TAHEchlU.h2tvfOpOki54NaHpGYKwdNhjaBuSpDotD7' | chpasswd -e
# Add a public ssh key and enable sshd
mkdir -pm700 /root/.ssh/
cat id_rsa_new.pub >> /root/.ssh/authorized_keys
systemctl enable sshd.service
# Install vim-small
zypper --non-interactive install vim-small
# Leave a marker
echo "Configured with combustion" > /etc/issue.d/combustion
</screen>
<para>The example script above sets a &rootuser; password, copies a ssh key (the ssh key must be located in the <filename>combustion</filename> directory) and installs the <emphasis>Vim</emphasis> editor with reduced features.</para>
</sect2>

<sect2 xml:id="sec-register-slem-system-suseconnect">
   <title>Registering with SUSEConnect</title>
   <para>
    Registering the system is  possible from
    the command line using <command>SUSEConnect</command>. For information that
    go beyond the scope of this section, refer to the inline documentation with
    <command>man 8 SUSEConnect</command>
   </para>
   <procedure>
    <title>Product registration with SUSEConnect</title>
    <step>
     <para>
      To register &productname; with &scc; run <command>SUSEConnect</command>
      as follows:
     </para>
     <screen>&prompt.user;sudo SUSEConnect -r <replaceable>REGISTRATION_CODE</replaceable> -e <replaceable>EMAIL_ADDRESS</replaceable></screen>
     <para>
      To register with a local registration server, additionally provide the URL
      to the server:
     </para>
     <screen>&prompt.user;sudo SUSEConnect -r <replaceable>REGISTRATION_CODE</replaceable> -e <replaceable>EMAIL_ADDRESS</replaceable> \
--url "https://suse_register.&exampledomain;/"</screen>
     <para>
      Replace <replaceable>REGISTRATION_CODE</replaceable> with the
      registration code you received with your copy of &productname;. Replace
      <replaceable>EMAIL_ADDRESS</replaceable> with the E-mail address
      associated with the &suse; account you or your organization uses to
      manage subscriptions.
     </para>
         </step>
    <step>
     <para>
      &productname; is now
      registered. 
     </para>
    </step>
   </procedure>
  </sect2>


</sect1>

</article>
