<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect2
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<!-- Converted by suse-upgrade version 1.1 -->
<sect2 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="sec.update.zypper">
 <title>Distributionsupgrade mit Zypper</title>
 <para>
  Mit dem Kommandozeilentool <command>zypper</command> können Sie die
  Distribution im laufenden Zustand auf der Shell aktualisieren.
 </para>
 <para>
  Dieses Feature richtet sich vor allem an fortgeschrittene Benutzer, die
  Upgrades auf entfernten Rechnern per SSH oder auf mehreren ähnlich
  konfigurierten Systemen gleichzeitig durchführen möchten.
 </para>
 <sect3>
  <title>Vorbereitungen</title>
  <para>
   Bevor Sie das Upgrade mit <command>zypper</command> durchführen, sollten
   Sie ein paar Vorbereitungen treffen, um mögliche Probleme zu vermeiden.
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Beenden Sie alle nicht benötigten Anwendungen und Dienste. Melden Sie
     außerdem andere Benutzer ab bzw. fordern diese auf, sich auszuloggen.
    </para>
   </listitem>
   <listitem>
    <para>
     Deaktivieren Sie Fremdquellen oder setzen Sie die Priorität dieser
     Drittanbieter-Repositories herab. So stellen Sie sicher, dass Pakete aus
     den Hauptquellen der Distribution den Vorrang haben. Nach dem Upgrade
     können Sie die zusätzlichen Repositories wieder aktivieren und dabei die
     Versionsnummer in der URL der Quelle an die neue Ausgabe der Distribution
     anpassen.
    </para>
   </listitem>
  </itemizedlist>
 </sect3>
 <sect3>
  <title>Der Upgrade-Prozess</title>
  <warning>
   <title>Kontrollieren Sie Ihr Backup</title>
   <para>
    Stellen Sie sicher, dass Sie ein aktuelles Backup Ihres Systems haben und
    dass Sie dieses im Zweifelsfall wiederherstellen können. Das ist
    insbesondere deshalb wichtig, weil Sie viele der folgenden Schritte von
    Hand durchführen werden.
   </para>
  </warning>
  <para>
   Das Programm <command>zypper</command> kennt lange und kurze Aufrufoptionen.
   So können Sie beispielsweise den Befehl <command>zypper install</command>
   zu <command>zypper in</command> verkürzen. Die nächsten Abschnitte
   verwenden die kurze Variante. Beachten Sie bitte, das Sie die folgenden
   Befehle sämtlich als Benutzer <systemitem class="username">root</systemitem>
   ausführen müssen.
  </para>
  <procedure>
   <step>
    <para>
     Führen Sie eine Online-Aktualisierung durch, um alle installierten Pakete
     auf den neuesten Stand zu bringen (siehe
     <xref linkend="cha.onlineupdate.you"/>).
    </para>
   </step>
   <step>
    <para>
     Richten Sie die Repositories ein, die Sie für das folgende Upgrade
     verwenden möchten. Es ist wichtig, dass Sie hier gut aufpassen und keine
     Tippfehler einbauen. Um die Quellen zu konfigurieren, greifen Sie entweder
     zu &yast; (siehe <xref linkend="sec.y2.sw.instsource"/>) oder zu
     <command>zypper</command> wie hier im Folgenden beschrieben. Abhängig
     von Ihrem Setup können die Namen in den nächsten Beispielen leicht
     abweichen.
    </para>
    <para>
     Um die aktuell aktivierten Repositories aufzulisten, geben Sie das
     folgende Kommando ein:
    </para>
    <screen>zypper --releasever=15.3 lr -u</screen>
    <para>
     Prüfen Sie in der letzten Spalte (<guimenu>URI</guimenu>) ob in allen
     Repository-Links die Versionsnummer <literal>15.3</literal> oder
     <literal>openSUSE_Leap_15.3</literal> auftaucht.
     Für alle Repositories, wo dies nicht der Fall ist, führen Sie bitte
     folgende Schritte durch:
    </para>
    <substeps>
     <step>
      <para>
       Prüfen Sie, ob Sie dieses Repository weiterhin brauchen und behalten
       wollen. Ist dies nicht der Fall, löschen Sie es mit dem Befehl
      </para>
      <screen>zypper rr <replaceable>NAME</replaceable></screen>
      <para>
       Wiederholen Sie dies für alle Repositories, die sie nicht mehr
       benötigen. Für die <literal>15.2</literal> Repositories die Sie behalten
       möchten, verfahren Sie wie folgt:
      </para>
     </step>
     <step>
      <para>
       Bei Repositories von Drittanbietern ohne Angabe einer Versionsnummer,
       versichern Sie sich bitte beim entsprechenden Anbieter, ob die Pakete im
       Repository openSUSE Leap 15.3 unterstützen. Ist dies der Fall, können
       Sie das Repository beibehalten. Ist dies nicht der Fall, entfernen Sie
       das Repository, wie im vorherigen Schritt beschrieben.
      </para>
     </step>
     <step>
      <para>
       Es ist empfehlenswert sich die Namen aller betroffenen Repositories zu
       notieren.  Nun müssen Sie für jedes der betroffenen Repositories die
       alte Version (<literal>15.2</literal>) löschen und eine Kopie für die
       Version <literal>15.3</literal> erzeugen:
      </para>
      <substeps performance="required">
       <step>
        <para>
         Der Vorgang wird im Folgenden beispielhaft für ein Repository mit
         folgenden Daten durchgeführt.
        </para>
        <simplelist>
         <member>Name: <literal>M17N:fonts</literal></member>
         <member>URI: <literal>https://download.opensuse.org/repositories/M17N:/fonts/openSUSE_Leap_15.2/</literal></member>
        </simplelist>
       </step>
       <step>
        <para>
         Löschen Sie das ursprüngliche Repository:
        </para>
        <screen>zypper rr "M17N:fonts"</screen>
       </step>
       <step>
        <para>
         Fügen Sie das neue Repository hinzu:
        </para>
        <screen>zypper ar -f \
        https://download.opensuse.org/repositories/M17N:/fonts/openSUSE_Leap_15.3/ \
        "M17N:fonts"</screen>
       </step>
       <step>
        <para>
         Schlägt das Hinzufügen des neuen Repositories fehl, prüfen Sie im
         Browser, ob das Repository existiert. Falls nicht, gibt es
         möglicherweise (noch) keine neuere Version. In diesem Fall
         deaktivieren Sie das ursprüngliche Repository:
        </para>
        <screen>zypper mr -d <replaceable>NAME</replaceable></screen>
        <para>
         Pakete von deaktivierten Quellen bleiben auf dem System, sofern es
         kein Problem mit Abhängigkeiten zu anderen Komponenten gibt.
        </para>
       </step>
       <step>
        <para>
         Falls Sie weitere Quellen eingerichtet haben, wiederholen Sie diese
         Schritte für alle Repositories, um ein sauberes Upgrade für sämtliche
         Pakete zu garantieren.
        </para>
       </step>
      </substeps>
     </step>
     <step>
      <para>
       Überprüfen Sie noch einmal die aktuelle Konfiguration der
       Paketquellen:
      </para>
      <screen>zypper --releasever=15.3 lr -u</screen>
      <para>
       Alle Repositories sollten nun auf einen Link für <literal>15.3</literal>
       zeigen. Ist dies nicht der Fall, sollte das Repository zumindest
       deaktiviert sein (Spalte <guimenu>Enabled</guimenu> sollte hier
       <literal>No</literal> ausgeben).
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     Aktualisieren Sie die Metadaten auf dem lokalen System und den Inhalt der
     Repositories mit dem Aufruf:
    </para>
    <screen>zypper --releasever=15.3 ref</screen>
   </step>
   <step>
    <para>
     Anschließend stoßen Sie das Distributions-Upgrade an:
    </para>
    <screen>zypper --releasever=15.3 dup</screen>
    <para>
     Abhängig von der Software-Auswahl müssen Sie eine oder
     mehrere Lizenzbestimmungen bestätigen.
    </para>
    <note>
     <title>Ungelöste Abhängigkeiten</title>
     <para>
      Der Befehl <command>zypper dup</command> entfernt alle Pakete, die
      ungelöste Abhängigkeiten aufweisen. Pakete von deaktivierten Quellen
      bleiben auf dem System, sofern es kein Problem mit Abhängigkeiten zu
      anderen Komponenten gibt.
     </para>
     <para>
      <command>zypper dup</command> stellt sicher, dass alle installierten
      Pakete aus einer der verfügbaren Quellen stammen. Das Tool
      berücksichtigt weder die Versionsnummer, noch die Architektur oder den
      Anbieter der installierten Pakete; somit bildet es eine Neuinstallation
      nach. Pakete, die aus den Repositories entfernt wurden, gelten als
      verwaist. Sie werden deinstalliert, falls <command>zypper</command> die
      Abhängigkeiten nicht auflösen kann. Andernfalls verbleiben sie auf dem
      System.
     </para>
    </note>
   </step>
   <step>
    <para>
     Booten Sie den Rechner mit dem Kommando <command>shutdown -r now</command>
     neu.
    </para>
   </step>
  </procedure>
 </sect3>
</sect2>
